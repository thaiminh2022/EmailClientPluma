<Window
    x:Class="EmailClientPluma.MVVM.Views.NewEmailView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:EmailClientPluma.MVVM.Views"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodels="clr-namespace:EmailClientPluma.MVVM.ViewModels"
    Title="NewEmailWindow"
    Width="800"
    Height="450"
    mc:Ignorable="d">
    <Window.DataContext>
        <viewmodels:NewEmailViewModel />
    </Window.DataContext>
    <Grid>
        <Grid.ColumnDefinitions />
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="149*" />
            <RowDefinition Height="auto" />
        </Grid.RowDefinitions>

        <Rectangle Grid.Row="0" Fill="AliceBlue"/>
        <Rectangle Grid.Row="1" Fill="AliceBlue"/>
        <Rectangle Grid.Row="2" Fill="AliceBlue" />

        <StackPanel>
            <Grid Margin="10" HorizontalAlignment="Stretch">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <!-- labels -->
                    <ColumnDefinition Width="*"/>
                    <!-- inputs -->
                </Grid.ColumnDefinitions>

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- From -->
                <TextBlock Grid.Row="0" Grid.Column="0"
                   Text="From"
                   FontFamily="Microsoft Sans Serif"
                   FontSize="18"
                   FontWeight="Bold"
                   VerticalAlignment="Center"
                   HorizontalAlignment="Right"
                   Margin="0,0,8,0" />
                <!-- right margin for gap -->

                <ComboBox Grid.Row="0" Grid.Column="1"
                  ItemsSource="{Binding Accounts}"
                  SelectedItem="{Binding SelectedAccount}"
                  MinWidth="300"
                  HorizontalAlignment="Stretch"
                  Margin="0,4,0,4">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Email}" />
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>

                <!-- To -->
                <TextBlock Grid.Row="1" Grid.Column="0"
                   Text="To"
                   FontFamily="Microsoft Sans Serif"
                   FontSize="18"
                   FontWeight="Bold"
                   VerticalAlignment="Center"
                   HorizontalAlignment="Right"
                   Margin="0,0,8,0" />

                <TextBox Grid.Row="1" Grid.Column="1"
                 Text="{Binding ToAddresses}"
                 MinWidth="300"
                 HorizontalAlignment="Stretch"
                 Margin="0,4,0,4" />

                <!-- Subject -->
                <TextBlock Grid.Row="2" Grid.Column="0"
                   Text="Subject"
                   FontFamily="Microsoft Sans Serif"
                   FontSize="18"
                   FontWeight="Bold"
                   VerticalAlignment="Center"
                   HorizontalAlignment="Right"
                   Margin="0,0,8,0" />

                <TextBox Grid.Row="2" Grid.Column="1"
                 Text="{Binding Subject}"
                 MinWidth="300"
                 HorizontalAlignment="Stretch"
                 Margin="0,4,0,4" />
            </Grid>
        </StackPanel>

        <Grid Grid.Row="1" Margin="0,10,0,0">
            <!--  Background image  -->
            <Image
                IsHitTestVisible="False"
                Opacity="1"
                Source="Images/bg.png"
                Stretch="UniformToFill" />
            <!--  Main TextBox  -->
            <RichTextBox
                x:Name="InputBox"
                BorderBrush="Black"
                BorderThickness="0,2,0,2"
                Padding="8"
                AcceptsReturn="True"
                AcceptsTab="True"
                Background="Transparent"
                VerticalScrollBarVisibility="Auto"
                FontSize="12"
                Foreground="Black"
                SelectionChanged="InputBox_SelectionChanged"
                local:RichTextBoxHelper.BoundDocument="{Binding InputText, Mode=TwoWay}"/>
        </Grid>
        <StackPanel
            Grid.Row="2"
            HorizontalAlignment="Left"
            Margin="10,0,0,0"
            Orientation="Horizontal">
            <Button Command="{Binding SendCommand}" Background="#0b57d0" Foreground="White">Send</Button>

            <Button Name="FontButton" Margin="10,0,0,0" Click="FontButton_Click" 
                    BorderBrush="AliceBlue" Background="AliceBlue">Fonts</Button>

            <!-- Popup for Fonts -->
            <Popup x:Name="FontPopup"
                   PlacementTarget="{Binding ElementName=FontButton}"
                   Placement="Top"
                   StaysOpen="True"
                   AllowsTransparency="True">

                <Border Background="WhiteSmoke"
                        CornerRadius="5"
                        Padding="10"
                        BorderBrush="LightGray"
                        BorderThickness="1">
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="8" ShadowDepth="3" Opacity="0.3"/>
                    </Border.Effect>

                    <StackPanel Orientation="Horizontal">

                        <!-- Font Family -->
                        <ComboBox x:Name="FontFamilyComboBox" Width="200" IsEditable="True"
                                  SelectionChanged="FontFamilyComboBox_SelectionChanged">
                            <ComboBoxItem Content="Arial"/>
                            <ComboBoxItem Content="Calibri"/>
                            <ComboBoxItem Content="Times New Roman"/>
                            <ComboBoxItem Content="Consolas"/>
                            <ComboBoxItem Content="Segoe UI"/>
                        </ComboBox>

                        <!-- Font Size -->
                        <ComboBox x:Name="FontSizeComboBox" Width="80" IsEditable="True"
                                  SelectionChanged="FontSizeComboBox_SelectionChanged">
                            <ComboBoxItem>8</ComboBoxItem>
                            <ComboBoxItem>10</ComboBoxItem>
                            <ComboBoxItem>12</ComboBoxItem>
                            <ComboBoxItem>14</ComboBoxItem>
                            <ComboBoxItem>16</ComboBoxItem>
                            <ComboBoxItem>18</ComboBoxItem>
                        </ComboBox>

                        <!-- Bold -->
                        <ToggleButton x:Name="BoldButton"
                                      Content="B"
                                      FontWeight="Bold"
                                      Width="30"
                                      Margin="2"
                                      Checked="BoldButton_Checked"
                                      Unchecked="BoldButton_Unchecked"/>

                        <!-- Italic -->
                        <ToggleButton x:Name="ItalicButton"
                                      Content="I"
                                      FontStyle="Italic"
                                      Width="30"
                                      Margin="2"
                                      Checked="ItalicButton_Checked"
                                      Unchecked="ItalicButton_Unchecked"/>

                        <!-- Underline -->
                        <ToggleButton x:Name="UnderlineButton"
                                      Width="30"
                                      Margin="2"
                                      Checked="UnderlineButton_Checked"
                                      Unchecked="UnderlineButton_Unchecked">
                            <TextBlock Text="U" TextDecorations="Underline"/>
                        </ToggleButton>
                    </StackPanel>
                </Border>
            </Popup>


            <Button Margin="10,0,0,0" BorderBrush="AliceBlue" Background="AliceBlue">Images</Button>
            <Button Margin="10,0,0,0" BorderBrush="AliceBlue" Background="AliceBlue">Files</Button>
            <Button Margin="10,0,0,0" BorderBrush="AliceBlue" Background="AliceBlue">Cancel</Button>

        </StackPanel>

        <Button x:Name="OptionsButton" Grid.Row="2" Margin="10,0,0,0" 
                HorizontalAlignment="Right" Click="OptionsButton_Click">Options</Button>
        <!--Option popup-->
        <Popup x:Name="OptionsPopup"
           PlacementTarget="{Binding ElementName=OptionsButton}"
           Placement="Top"
           StaysOpen="False"
           AllowsTransparency="True"
           PopupAnimation="Slide">
            <Border Background="WhiteSmoke"
                CornerRadius="8"
                Padding="10"
                BorderBrush="LightGray"
                BorderThickness="1">
                <StackPanel>
                    <Button Margin="0,0,0,5" Content="Check for Spelling"/>
                    <Button x:Name="LabelsButton" Content="Labels" Click="LabelsButton_Click"/>
                </StackPanel>
            </Border>
        </Popup>

        <!--Label submenu-->
        <Popup x:Name="LabelsPopup"
           PlacementTarget="{Binding ElementName=LabelsButton}"
           Placement="Right"
           StaysOpen="False"
           AllowsTransparency="True"
           PopupAnimation="Slide">
            <Border Background="WhiteSmoke"
                CornerRadius="8"
                Padding="10"
                BorderBrush="LightGray"
                BorderThickness="1">
                <StackPanel Width="200">
                    <TextBlock Text="Create Label" FontWeight="Bold" Margin="0,0,0,8"/>
                    <TextBox x:Name="LabelNameBox" Margin="0,0,0,10"/>

                    <TextBlock Text="Category" FontWeight="SemiBold" Margin="0,0,0,4"/>
                    <CheckBox Content="Ad" Margin="0,2"/>
                    <CheckBox Content="Social" Margin="0,2"/>
                    <CheckBox Content="Forum" Margin="0,2"/>
                    <CheckBox Content="Promotions" Margin="0,2"/>

                    <Button Content="Save" Margin="0,8,0,0" HorizontalAlignment="Right"/>
                </StackPanel>
            </Border>
        </Popup>

    </Grid>
</Window>